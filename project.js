require=function t(e,i,n){function a(s,r){if(!i[s]){if(!e[s]){var o="function"==typeof require&&require;if(!r&&o)return o(s,!0);if(c)return c(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return a(i?i:t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var c="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({Animation:[function(t,e,i){Fire._RFpush(e,"1c3ccoPotRNBJp4DlfcdGM9","Animation");var n=function(t){for(var e,i,n=[],a=t.startIdx;a<t.startIdx+t.count;a++){var c=a;i=t.name+c+".png",e=cc.spriteFrameCache.getSpriteFrame(i),n.push(e)}return new cc.Animation(n,t.delay)},a=function(t){return cc.animate(n(t))};e.exports={createAnimation:n,createAnimAction:a},Fire._RFpop()},{}],BattleMng:[function(t,e,i){function n(t,e){return Math.floor(Math.random()*(e-t))+t}Fire._RFpush(e,"5e1eerr6JZIZIl2FzoR6XBb","BattleMng");Fire.Class({"extends":Fire.Behavior,onLoad:function(){this.uiManager=Fire.engine.getCurrentSceneN().getChildByName("uiLayer"),this.fighters=this.getChildren(),this.players=[],this.enemies=[];for(var t=0;t<this.fighters.length;++t){var e=this.fighters[t];e.isEnemy?this.enemies.push(e):this.players.push(e)}this.registerInput()},registerInput:function(){var t=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e,i){e===cc.KEY.space&&t.launchRandomAttack()}},t),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e,i){t.launchRandomAttack()}},t)},launchRandomAttack:function(){var t=this.fighters.filter(function(t){return t.canMove}),e=t.length;if(e>1){var i=n(0,e),a=t[i];a.canMove=!1;for(var c=null,s=0;s<t.length;++s)if(a.isEnemy!==t[s].isEnemy){c=t[s];break}c?(a.moveToAttack(c),this.uiManager.playPop(this.fighters.indexOf(a))):a.canMove=!0}}});Fire._RFpop()},{}],FXManager:[function(t,e,i){Fire._RFpush(e,"614263AlCBKqKbCvMD2ExRn","FXManager");var n=t("Animation"),a=Fire.defineEnum({Blood:-1,Boom:-1,Dust:-1,Hit:-1,Flash:-1}),c=[{name:"blood_splash_",count:3,startIdx:1,delay:.05},{name:"boom_0",count:6,startIdx:1,delay:.1},{name:"fog_0",count:7,startIdx:1,delay:.1},{name:"hit_0",count:4,startIdx:1,delay:.05},{name:"coin_gather_",count:3,startIdx:1,delay:.07}],s=function(t){return c[t]},r=cc.Sprite.extend({ctor:function(t,e){this._super(),r.fxID++,this.fxID=r.fxID,t.addChild(this);var i="fx_"+a[e]+this.fxID;this.setName(i);var c=n.createAnimAction(s(e)),o=cc.callFunc(this.onPlayEnd,this);this.runAction(cc.sequence(c,o))},newAnim:function(t){var e=n.createAnimAction(s(t)),i=cc.callFunc(this.onPlayEnd,this);this.runAction(cc.sequence(e,i))},onPlayEnd:function(){this.removeFromParent(),cc.pool.putInPool(this)}});r.fxID=0;var o=Fire.Class({"extends":Fire.Behavior,statics:{FXType:a,getAnimInfo:s},properties:{fxAtlasAsset:{"default":"",url:Runtime.SpriteAtlas}},onLoad:function(){this.fxAtlasAsset&&cc.spriteFrameCache.addSpriteFrames(this.fxAtlasAsset),o.instance=this},_spawnFX:function(t,e){var i;return cc.pool.hasObject(r)?(i=cc.pool.getFromPool(r),i.newAnim(e),t.addChild(i),i):i=new r(this,e)},playFX:function(t,e,i,n){var c=n||this,s=this._spawnFX(c,e);return e===a.Hit?s.setScale(.5):s.setScale(1),i=i>0?1:-1,s.setScaleX(i),s.setPosition(t),s}});Fire._RFpop()},{Animation:"Animation"}],Fighter:[function(t,e,i){Fire._RFpush(e,"d447fGdAC9J9IVvsX8QqEeH","Fighter");var n=t("FXManager");Fire.Class({"extends":Fire.Behavior,properties:{isEnemy:!1,moveForwardDuration:0,moveBackwardDuration:0,attackFreezeDuration:0,hurtFX:0,attackOffset:0,idleTexture:{"default":null,url:Fire.Texture},atkTexture:{"default":null,url:Fire.Texture}},onLoad:function(){this.canMove=!0,this.targetFighter=null,this.origZ=this.getLocalZOrder(),this.flash=this.getChildByName("flash"),this.flash.setOpacity(0),this.actionMoveForward=null,this.actionMoveBackward=null,this.actionIdle=cc.repeatForever(cc.sequence(cc.scaleTo(1,this.getScaleX(),.55),cc.scaleTo(1,this.getScaleX(),.6))),this.targetPos=cc.p(0,0),this.selfPos=cc.p(this.x,this.y),this.actionMoveBackward=cc.moveTo(this.moveBackwardDuration,this.selfPos).easing(cc.easeCubicActionOut()),this.idle()},idle:function(){this.runAction(this.actionIdle)},moveToAttack:function(t){this.stopAction(this.actionIdle),this.canMove=!1,this.setLocalZOrder(this.orgiZ+.5),this._assignTarget(t,this.attackOffset);var e=cc.callFunc(this._playAttack,this),i=n.instance.playFX(cc.p(this.x,this.y+50),n.FXType.Dust,this.getScaleX(),this.getParent());i.setLocalZOrder(this.origZ-.5),this.runAction(cc.sequence(this.actionMoveForward,e))},hurt:function(t){this.stopAction(this.actionIdle),this.canMove=!1;var e=cc.moveBy(this.attackFreezeDuration,cc.p(t,0)).easing(cc.easeElasticInOut(.2)),i=cc.moveBy(this.attackFreezeDuration,cc.p(-t,0)).easing(cc.easeElasticInOut(.2)),a=cc.callFunc(this._onHurtEnd,this),c=cc.sequence(e,i,a),s=cc.fadeIn(this.attackFreezeDuration/2),r=cc.fadeOut(this.attackFreezeDuration/2),o=cc.sequence(s,r);n.instance.playFX(cc.p(this.x+t,this.y+80),n.FXType.Blood,this.getScaleX()),this.runAction(c),this.flash.runAction(o)},_assignTarget:function(t,e){this.targetFighter=t,this.targetPos=cc.p(t.x+e,t.y),this.actionMoveForward=cc.jumpTo(this.moveForwardDuration,this.targetPos,30,1).easing(cc.easeCubicActionOut())},_showAtkPose:function(){this.setTexture(this.atkTexture)},_showIdlePose:function(){this.setTexture(this.idleTexture)},_playHitFreeze:function(){this.attackOffset;setTimeout(function(){this._moveBack()}.bind(this),1e3*this.attackFreezeDuration)},_playAttack:function(){var t=this.attackOffset;this._showAtkPose();var e=cc.callFunc(this._playHitFreeze,this),i=cc.sequence(cc.moveBy(this.attackFreezeDuration/4,cc.p(-t,0)),e);n.instance.playFX(cc.p(this.x-t,0),n.FXType.Hit,this.targetFighter.getScaleX()),this.runAction(i),this.targetFighter.hurt(-t)},_moveBack:function(){this._showIdlePose();var t=cc.callFunc(this._onAtkEnd,this);this.runAction(cc.sequence(this.actionMoveBackward,t))},_onAtkEnd:function(){this.setLocalZOrder(this.origZ),this.canMove=!0,this.idle()},_onHurtEnd:function(){this.canMove=!0,this.idle()}});Fire._RFpop()},{FXManager:"FXManager"}],UIMng:[function(t,e,i){Fire._RFpush(e,"5853cbzYTNCAo3RbX4Qepgh","UIMng");var n=t("FXManager");Fire.Class({"extends":Fire.Behavior,onLoad:function(){this.icons=this.getChildren(),this.playerIcons=[],this.enemyIcons=[],this.origScale=.25;for(var t=0;t<this.icons.length;++t){var e=this.icons[t];e.setScale(this.origScale)}this.actionPop=cc.sequence(cc.scaleTo(.2,1.4*this.origScale).easing(cc.easeBackOut()),cc.scaleTo(.2,this.origScale).easing(cc.easeBackOut()))},playPop:function(t){var e=this.icons[t];if(e){e.runAction(this.actionPop);n.instance.playFX(cc.p(e.x,e.y),n.FXType.Flash,1)}}});Fire._RFpop()},{FXManager:"FXManager"}]},{},["Animation","UIMng","BattleMng","FXManager","Fighter"]);
//# sourceMappingURL=project.js.map